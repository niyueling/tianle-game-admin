(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-64c145a2"],{"0bb6":function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return l})),a.d(t,"e",(function(){return o})),a.d(t,"b",(function(){return n})),a.d(t,"f",(function(){return c})),a.d(t,"g",(function(){return d}));var i=a("f175");const s=e=>i.a.post("/marketing.seckill/add",e),r=e=>i.a.post("/marketing.seckill/edit",e),l=e=>i.a.get("/marketing.seckill/detail",{params:e}),o=e=>i.a.get("/marketing.seckill/lists",{params:e}),n=e=>i.a.post("/marketing.seckill/delete",e),c=e=>i.a.post("/marketing.seckill/open",{params:e}),d=e=>i.a.post("/marketing.seckill/stop",{params:e})},"5f8a":function(e,t,a){"use strict";var i=a("9ab4"),s=a("1b40");let r=class extends s.e{constructor(){super(...arguments),this.pickerValue=[],this.pickerOptions={shortcuts:[{text:"最近一周",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]}}changeDate(){const e=this.pickerValue?this.pickerValue:this.pickerValue=["",""];this.$emit("update:start-time",e[0]),this.$emit("update:end-time",e[1])}handleStartTime(e){!this.pickerValue&&(this.pickerValue=[]),this.$set(this.pickerValue,0,e)}handleEndTime(e){!this.pickerValue&&(this.pickerValue=[]),this.$set(this.pickerValue,1,e)}};Object(i.a)([Object(s.c)()],r.prototype,"startTime",void 0),Object(i.a)([Object(s.c)()],r.prototype,"endTime",void 0),Object(i.a)([Object(s.c)({default:"datetimerange"})],r.prototype,"type",void 0),Object(i.a)([Object(s.c)({default:!1})],r.prototype,"disabled",void 0),Object(i.a)([Object(s.f)("startTime",{immediate:!0})],r.prototype,"handleStartTime",null),Object(i.a)([Object(s.f)("endTime",{immediate:!0})],r.prototype,"handleEndTime",null),r=Object(i.a)([s.a],r);var l=r,o=a("2877"),n=Object(o.a)(l,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("el-date-picker",{attrs:{type:e.type,"picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",align:"right","value-format":"yyyy-MM-dd HH:mm:ss",disabled:e.disabled},on:{change:e.changeDate},model:{value:e.pickerValue,callback:function(t){e.pickerValue=t},expression:"pickerValue"}})}),[],!1,null,null,null);t.a=n.exports},"8afc":function(e,t,a){"use strict";a("a6e7")},a6e7:function(e,t,a){},c1f0:function(e,t,a){"use strict";a.r(t);var i=a("9ab4"),s=a("1b40"),r=a("b3ad"),l=a("f50c"),o=a("5f8a"),n=a("0bb6");let c=class extends s.e{constructor(){super(...arguments),this.loading=!1,this.disabled=!1,this.formData={name:"",explain:"",start_time:"",status:1,end_time:"",goods:[],max_buy:0},this.selectGoods=[],this.rules={name:[{required:!0,message:"请输入活动名称",trigger:["blur"]}],start_time:[{required:!0,message:"选择活动时间",trigger:"blur"}],max_buy:[{required:!0,message:"请输入每单限制数量",trigger:"blur"}]}}selectGoodsChange(e){this.formData.goods=e.map(e=>({goods_id:e.id,items:e.item.map(e=>({item_id:e.id,seckill_price:e.seckill_price}))}))}checkGoods(){const e=this.formData.goods;if(!e.length)return this.$message.error("请选择秒杀商品"),!1;for(let t=0;t<e.length;t++)for(let a=0;a<e[t].items.length;a++)if(!e[t].items[a].seckill_price)return this.$message.error("请输入商品秒杀价"),!1;return!0}handleInput(e,t){e<=0&&""!==e&&(this.formData[t]=1)}handleSave(){this.$refs.form.validate((e,t)=>{if(!e)return!1;if(!this.checkGoods())return;(this.id?Object(n.d)(this.formData):Object(n.a)(this.formData)).then(()=>{this.$router.go(-1)})})}getDetail(){this.loading=!0,Object(n.c)({id:this.id}).then(e=>{this.formData=e,this.selectGoods=e.goods,this.loading=!1})}created(){this.id=this.$route.query.id,this.disabled=Boolean(this.$route.query.disabled),this.id&&this.getDetail()}};Object(i.a)([Object(s.f)("selectGoods",{deep:!0})],c.prototype,"selectGoodsChange",null),c=Object(i.a)([Object(s.a)({components:{MaterialSelect:r.a,DatePicker:o.a,GoodsSelect:l.a}})],c);var d=c,m=(a("8afc"),a("2877")),u=Object(m.a)(d,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ls-seckill-edit"},[a("div",{staticClass:"ls-card ls-seckill-edit__header"},[a("el-page-header",{attrs:{content:e.id?e.disabled?"秒杀活动详情":"编辑秒杀活动":"新增秒杀活动"},on:{back:function(t){return e.$router.go(-1)}}})],1),a("div",{staticClass:"ls-seckill-content"},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{model:e.formData,"label-width":"120px",size:"small",rules:e.rules,disabled:e.disabled}},[a("div",{staticClass:"ls-card m-t-16"},[a("div",{staticClass:"nr weight-500 m-b-20"},[e._v("活动设置")]),a("el-form-item",{attrs:{label:"活动名称",prop:"name"}},[a("el-input",{staticClass:"ls-input",attrs:{placeholder:"请输入活动名称"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),a("el-form-item",{attrs:{label:"活动时间",prop:"start_time"}},[a("date-picker",{attrs:{disabled:1!=e.formData.status,type:"datetimerange","start-time":e.formData.start_time,"end-time":e.formData.end_time},on:{"update:startTime":function(t){return e.$set(e.formData,"start_time",t)},"update:start-time":function(t){return e.$set(e.formData,"start_time",t)},"update:endTime":function(t){return e.$set(e.formData,"end_time",t)},"update:end-time":function(t){return e.$set(e.formData,"end_time",t)}}}),a("div",{staticClass:"muted"},[e._v("秒杀活动开始和结束时间，可以手动提前结束活动")])],1),a("el-form-item",{attrs:{label:"活动备注"}},[a("el-input",{staticClass:"ls-input",attrs:{type:"textarea",rows:5,placeholder:""},model:{value:e.formData.explain,callback:function(t){e.$set(e.formData,"explain",t)},expression:"formData.explain"}})],1)],1),a("div",{staticClass:"ls-card m-t-16"},[a("div",{staticClass:"nr weight-500 m-b-20"},[e._v("活动商品")]),a("el-form-item",{attrs:{label:"秒杀商品",required:""}},[a("goods-select",{attrs:{disabled:e.disabled||1!=e.formData.status,mode:"table","is-spec":!0,limit:25,extend:{name:"秒杀",price:[{title:"秒杀价格",key:"seckill_price"}]}},model:{value:e.selectGoods,callback:function(t){e.selectGoods=t},expression:"selectGoods"}},[a("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("选择秒杀商品")])],1)],1)],1),a("div",{staticClass:"ls-card m-t-16"},[a("div",{staticClass:"nr weight-500 m-b-20"},[e._v("活动规则")]),a("el-form-item",{attrs:{label:"每单限制",required:""}},[a("el-radio-group",{attrs:{disabled:1!=e.formData.status},model:{value:e.formData.max_buy,callback:function(t){e.$set(e.formData,"max_buy",t)},expression:"formData.max_buy"}},[a("el-radio",{attrs:{label:0}},[e._v("不限制")]),a("el-radio",{attrs:{label:0!=e.formData.max_buy?e.formData.max_buy:""}},[e._v("限制")])],1)],1),0!==e.formData.max_buy?a("el-form-item",{attrs:{prop:"max_buy",label:""}},[a("el-input",{attrs:{disabled:1!=e.formData.status,type:"number"},on:{input:function(t){return e.handleInput(t,"max_buy")}},model:{value:e.formData.max_buy,callback:function(t){e.$set(e.formData,"max_buy",t)},expression:"formData.max_buy"}}),a("div",{staticClass:"muted"},[e._v("每件商品单笔订单最多购买的件数。")])],1):e._e()],1)])],1),a("div",{staticClass:"ls-seckill-edit__footer bg-white ls-fixed-footer"},[a("div",{staticClass:"btns row-center flex",staticStyle:{height:"100%"}},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.$router.go(-1)}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary",disabled:e.disabled},on:{click:e.handleSave}},[e._v("保存")])],1)])])}),[],!1,null,"f18120b2",null);t.default=u.exports}}]);