(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-16fbbb46"],{"335c":function(t,e,s){"use strict";s.r(e);var i=s("9ab4"),a=s("6ddb"),l=s("1b40"),n=s("c6fe");let c=class extends l.e{constructor(){super(...arguments),this.activeName="image",this.paneLists=[{label:"图片",name:"image",type:"image"},{label:"视频",name:"video",type:"video"}],this.pager=new a.a}getList(){}};c=Object(i.a)([Object(l.a)({components:{MaterialItem:n.a}})],c);var r=c,o=(s("4cc4"),s("2877")),d=Object(o.a)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ls-material flex-col"},[s("div",{staticClass:"ls-material__content ls-card flex-col"},[s("div",{staticClass:"ls-content__tabs flex-col"},[s("el-tabs",{directives:[{name:"loading",rawName:"v-loading",value:t.pager.loading,expression:"pager.loading"}],staticClass:"flex-col",on:{"tab-click":t.getList},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},t._l(t.paneLists,(function(t,e){return s("el-tab-pane",{key:e,attrs:{label:t.label,name:t.name,lazy:""}},[s("material-item",{attrs:{type:t.type,mode:"pages",size:"160"}})],1)})),1)],1)])])}),[],!1,null,"84323de4",null);e.default=d.exports},"481a":function(t,e,s){"use strict";s("d355")},4885:function(t,e,s){},"4cc4":function(t,e,s){"use strict";s("4885")},"783d":function(t,e,s){"use strict";s("e0ad")},c6fe:function(t,e,s){"use strict";var i=s("9ab4"),a=s("1b40"),l=s("d455"),n=s("3c50"),c=s("0a6d"),r=s("d70b"),o=s("e4f6");let d=class extends a.e{constructor(){super(...arguments),this.visible=!1,this.action=`${r.a.baseURL}/adminapi/upload/${this.type}`,this.fileList=[],this.version=r.a.version}handleProgress(t,e,s){this.visible=!0,this.fileList=s}handleSuccess(t,e,s){s.every(t=>"success"==t.status)&&(this.$refs.upload.clearFiles(),this.visible=!1),this.$emit("change"),0==t.code&&t.show&&this.$message.error(t.msg)}handleError(t,e){this.$message.error(e.name+"文件上传失败"),this.$refs.upload.abort(),this.visible=!1,this.$emit("change"),this.$emit("error")}handleExceed(){this.$message.error("超出上传上限，请重新上传")}handleClose(){this.$refs.upload.abort(),this.$refs.upload.clearFiles(),this.visible=!1}};Object(i.a)([Object(a.c)({default:10})],d.prototype,"limit",void 0),Object(i.a)([Object(a.c)({default:!0})],d.prototype,"multiple",void 0),Object(i.a)([Object(a.c)({default:()=>{}})],d.prototype,"data",void 0),Object(i.a)([Object(a.c)({default:"image"})],d.prototype,"type",void 0),Object(i.a)([Object(a.c)({default:!1})],d.prototype,"showProgress",void 0),d=Object(i.a)([Object(a.a)({components:{UploadList:o.a}})],d);var p=d,u=s("2877"),h=Object(u.a)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-upload",{ref:"upload",staticClass:"ls-upload",attrs:{action:t.action,multiple:t.multiple,limit:t.limit,"show-file-list":!1,headers:{token:t.$store.getters.token,version:t.version},data:t.data,"on-progress":t.handleProgress,"on-success":t.handleSuccess,"on-exceed":t.handleExceed,"on-error":t.handleError}},[t._t("default")],2),t.showProgress&&t.fileList.length?s("el-dialog",{attrs:{title:"上传进度",visible:t.visible,top:"20vh","close-on-click-modal":!1,width:"500px",modal:!1,"before-close":t.handleClose},on:{"update:visible":function(e){t.visible=e}}},[s("div",{staticClass:"file-list"},[t._l(t.fileList,(function(e,i){return[s("div",{key:i,staticClass:"m-b-20"},[s("div",[t._v(t._s(e.name))]),s("div",{staticClass:"flex-1"},[s("el-progress",{attrs:{percentage:parseInt(e.percentage)}})],1)])]}))],2)]):t._e()],1)}),[],!1,null,"1a92e580",null).exports,m=s("e915"),g=s("db85"),v=s("6ddb");let b=class extends a.e{constructor(){super(...arguments),this.name="",this.moveId=0,this.checkAll=!1,this.isIndeterminate=!1,this.currentId="",this.fileList=[],this.groupeLists=[],this.pager=new v.a({size:this.pageSize}),this.selectList=[]}get typeValue(){switch(this.type){case"image":return 10;case"video":return 20;case"file":return 30}}selectListChange(t){if(this.$emit("change",t),t.length==this.pager.lists.length&&0!==t.length)return this.isIndeterminate=!1,void(this.checkAll=!0);t.length>0?this.isIndeterminate=!0:(this.checkAll=!1,this.isIndeterminate=!1)}get selectStatus(){return t=>this.selectList.find(e=>e.id==t)}async getGroupeList(){const t=await Object(g.f)({type:this.typeValue,page_type:1});this.groupeLists=null==t?void 0:t.lists,this.groupeLists.unshift({name:"全部",id:""},{name:"未分组",id:0})}getList(t){t&&(this.pager.page=t),"pages"==this.mode&&this.clearSelectList(),this.pager.request({callback:g.e,params:{type:this.typeValue,cid:this.currentId,name:this.name}})}addGroupe(t,e){if(!t)return this.$message.error("请输入分组名称");Object(g.a)({type:this.typeValue,pid:0|e,name:t}).then(t=>{this.getData()})}editGroupe(t,e){if(!t)return this.$message.error("请输入分组名称");Object(g.d)({name:t,id:e}).then(t=>{this.getData()})}delGroupe(t){Object(g.c)({id:t}).then(t=>{this.getData()})}async getData(){this.pager.loading=!0,await this.getGroupeList(),this.pager.loading=!1,this.getList()}currentChange({id:t}){this.name="",this.currentId=t,this.getList()}selectFile(t){const e=this.selectList.findIndex(e=>e.id==t.id);if(-1==e)return"popup"==this.mode&&this.selectList.length==this.limit?1==this.limit?(this.selectList=[],void this.selectList.push(t)):void this.$message.warning("已达到选择上限"):void this.selectList.push(t);this.selectList.splice(e,1)}selectAll(t){this.isIndeterminate=!1,t?this.selectList=[...this.pager.lists]:this.clearSelectList()}batchFileDel(t){const e=t||this.selectList.map(t=>t.id);Object(g.b)({ids:e}).then(t=>{this.getList()})}batchFileMove(){const t=this.selectList.map(t=>t.id);Object(g.g)({ids:t,cid:this.moveId}).then(t=>{this.moveId=0,this.getList()})}fileRename(t,e){Object(g.h)({id:e,name:t}).then(()=>{this.getList()})}delImage(t){this.selectList=this.selectList.filter(e=>e.id!=t)}clearSelectList(){this.selectList=[]}created(){this.getData()}};Object(i.a)([Object(a.c)({default:"image"})],b.prototype,"type",void 0),Object(i.a)([Object(a.c)({default:"100"})],b.prototype,"size",void 0),Object(i.a)([Object(a.c)({default:"popup"})],b.prototype,"mode",void 0),Object(i.a)([Object(a.c)({default:20})],b.prototype,"pageSize",void 0),Object(i.a)([Object(a.c)()],b.prototype,"limit",void 0),Object(i.a)([Object(a.f)("selectList")],b.prototype,"selectListChange",null),b=Object(i.a)([Object(a.a)({components:{LsPagination:n.a,PopoverInput:l.a,LsDialog:c.a,LsUpload:h,FileItem:m.a}})],b);var f=b,y=(s("783d"),Object(u.a)(f,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.pager.loading,expression:"pager.loading"}],staticClass:"material flex col-stretch"},[i("div",{staticClass:"material__left"},[i("el-scrollbar",{staticClass:"ls-scrollbar",staticStyle:{height:"calc(100% - 80px)"}},[i("div",{staticClass:"material-left__content p-t-16"},[i("el-tree",{attrs:{"node-key":"id",data:t.groupeLists,"empty-text":"","highlight-current":!0,"expand-on-click-node":!1,"icon-class":"el-icon-arrow-right","current-node-key":t.currentId},on:{"node-click":t.currentChange},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.data;return[i("div",{staticClass:"flex flex-1"},[i("img",{staticClass:"m-r-10",staticStyle:{width:"20px",height:"16px"},attrs:{src:s("f0b8"),alt:""}}),i("span",{staticClass:"flex-1 line-1 m-r-10",staticStyle:{"max-width":"120px"}},[t._v(t._s(a.name))]),a.id>0?i("el-dropdown",[i("span",{staticClass:"muted m-r-10"},[t._v("···")]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("div",[i("popover-input",{attrs:{type:"text",tips:"分类名称"},on:{confirm:function(e){return t.editGroupe(e,a.id)}}},[i("el-dropdown-item",[t._v("命名分组")])],1)],1),i("div",{on:{click:function(e){return t.delGroupe(a.id)}}},[i("el-dropdown-item",[t._v("删除分组")])],1)])],1):t._e()],1)]}}])})],1)]),i("div",{staticClass:"flex row-center p-16"},[i("popover-input",{attrs:{tips:"分类名称",type:"text"},on:{confirm:t.addGroupe}},[i("el-button",{attrs:{size:"small"}},[t._v("添加分组")])],1)],1)],1),i("div",{staticClass:"material__center flex-1 p-16 flex-col"},[i("div",{staticClass:"material-center__btn flex row-between"},[i("div",{staticClass:"flex"},[i("ls-upload",{staticClass:"m-r-10",attrs:{data:{cid:t.currentId},type:t.type,"show-progress":!0},on:{change:function(e){return t.getList(1)}}},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v("本地上传")])],1),"pages"==t.mode?[i("ls-dialog",{staticClass:"m-r-10 inline",attrs:{content:"确定删除选中的文件？",disabled:!t.selectList.length},on:{confirm:t.batchFileDel}},[i("el-button",{attrs:{slot:"trigger",size:"small",disabled:!t.selectList.length},slot:"trigger"},[t._v("删除")])],1),i("ls-dialog",{staticClass:"m-r-10 inline",attrs:{disabled:!t.selectList.length,title:"移动文件"},on:{confirm:t.batchFileMove}},[i("el-button",{attrs:{slot:"trigger",size:"small",disabled:!t.selectList.length},slot:"trigger"},[t._v("移动")]),i("div",[i("span",{staticClass:"m-r-20"},[t._v("移动文件至")]),i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.moveId,callback:function(e){t.moveId=e},expression:"moveId"}},t._l(t.groupeLists,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)],1)]:t._e()],2),i("el-input",{staticStyle:{width:"280px"},attrs:{size:"small",placeholder:"请输入名字"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getList(1)}},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(e){return t.getList(1)}},slot:"append"})],1)],1),i("div",{staticClass:"material-center__content flex-col flex-1"},[i("ul",{staticClass:"file-list flex flex-wrap m-t-16"},t._l(t.pager.lists,(function(e){return i("li",{key:e.id,staticClass:"file-item-wrap ls-del-wrap",style:{width:t.size+"px"},on:{click:function(s){return t.selectFile(e)}}},[i("file-item",{attrs:{type:t.type,item:e,size:t.size}},[t.selectStatus(e.id)?i("div",{staticClass:"item-selected"},[i("i",{staticClass:"el-icon-check white icon-selected"})]):t._e()]),i("div",{staticClass:"item-name line-1 xs p-t-10"},[t._v(t._s(e.name))]),"pages"==t.mode?i("div",{staticClass:"operation-btns",on:{click:function(t){t.stopPropagation()}}},[i("ls-dialog",{staticClass:"m-r-10 inline",attrs:{content:"确定删除该文件？"},on:{confirm:function(s){return t.batchFileDel([e.id])}}},[i("el-button",{attrs:{slot:"trigger",size:"small",type:"text"},slot:"trigger"},[t._v("删除")])],1),i("popover-input",{attrs:{value:e.name,type:"text"},on:{confirm:function(s){return t.fileRename(s,e.id)}}},[i("el-button",{attrs:{size:"small",type:"text"}},[t._v("重命名")])],1),i("a",{staticClass:"m-l-10",attrs:{href:e.uri,target:"_blank"}},[i("el-button",{attrs:{size:"small",type:"text"}},[t._v("查看")])],1)],1):t._e(),t.selectStatus(e.id)||"popup"!=t.mode?t._e():i("i",{staticClass:"el-icon-close ls-icon-del",on:{click:function(s){return s.stopPropagation(),t.batchFileDel([e.id])}}})],1)})),0),t.pager.loading||t.pager.lists.length?t._e():i("div",{staticClass:"flex flex-1 row-center col-center"},[t._v(" 暂无数据~ ")])]),i("div",{staticClass:"material-center__footer flex row-between flex-wrap p-b-16"},["pages"==t.mode?i("div",{staticClass:"btn"},[i("span",{staticClass:"m-r-10"},[i("el-checkbox",{attrs:{disabled:!t.pager.lists.length,indeterminate:t.isIndeterminate},on:{change:t.selectAll},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("当页全选")])],1),i("ls-dialog",{staticClass:"m-r-10 inline",attrs:{content:"确定删除选中的图片？",disabled:!t.selectList.length},on:{confirm:t.batchFileDel}},[i("el-button",{attrs:{slot:"trigger",size:"small",disabled:!t.selectList.length},slot:"trigger"},[t._v("删除")])],1),i("ls-dialog",{staticClass:"m-r-10 inline",attrs:{disabled:!t.selectList.length,title:"移动图片"},on:{confirm:t.batchFileMove}},[i("el-button",{attrs:{slot:"trigger",size:"small",disabled:!t.selectList.length},slot:"trigger"},[t._v("移动")]),i("div",[i("span",{staticClass:"m-r-20"},[t._v("移动图片至")]),i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.moveId,callback:function(e){t.moveId=e},expression:"moveId"}},t._l(t.groupeLists,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)],1)],1):t._e(),i("ls-pagination",{attrs:{layout:"total, prev, pager, next, jumper"},on:{change:function(e){return t.getList()}},model:{value:t.pager,callback:function(e){t.pager=e},expression:"pager"}})],1)]),"popup"==t.mode?i("div",{staticClass:"material__right"},[i("div",{staticClass:"flex row-between"},[i("div",{staticClass:"sm"},[t._v(" 已选择 "+t._s(t.selectList.length)+" "),t.limit?i("span",[t._v("/"+t._s(t.limit))]):t._e()]),i("el-button",{attrs:{type:"text",size:"small"},on:{click:t.clearSelectList}},[t._v("清空")])],1),i("el-scrollbar",{staticClass:"ls-scrollbar",staticStyle:{height:"calc(100% - 32px)"}},[i("ul",{staticClass:"flex-col p-t-10"},t._l(t.selectList,(function(e){return i("li",{key:e.id,staticClass:"m-b-16"},[i("div",{staticClass:"ls-del-wrap"},[i("file-item",{attrs:{type:t.type,item:e}}),i("i",{staticClass:"el-icon-close ls-icon-del",on:{click:function(s){return t.delImage(e.id)}}})],1)])})),0)])],1):t._e()])}),[],!1,null,"0253d21b",null));e.a=y.exports},d355:function(t,e,s){},e0ad:function(t,e,s){},e915:function(t,e,s){"use strict";var i=s("9ab4"),a=s("1b40");let l=class extends a.e{};Object(i.a)([Object(a.c)({default:()=>{}})],l.prototype,"item",void 0),Object(i.a)([Object(a.c)({default:"100"})],l.prototype,"size",void 0),Object(i.a)([Object(a.c)({default:"image"})],l.prototype,"type",void 0),l=Object(i.a)([Object(a.a)({})],l);var n=l,c=(s("481a"),s("2877")),r=Object(c.a)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"file-item",style:{height:t.size+"px",width:t.size+"px"}},["image"==t.type?s("el-image",{staticClass:"image",attrs:{fit:"contain",src:t.item.uri}}):"video"==t.type?s("video",{staticClass:"video",attrs:{src:t.item.uri}}):t._e(),t._t("default")],2)}),[],!1,null,"35f4f9dc",null);e.a=r.exports},f0b8:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAMAAABXc8oyAAAAbFBMVEUAAAD/6ZX/4oz/6ZX/6ZX//5n/6ZX/6ZX/6JX/6JP/6JD5xzT4yTb/6Jb6yDP/6Zf5xTP/6pX5xzX/6ZX5xzX/6JX4xjP5yDP5yjr5yDX/55T/6JX6xzP/55f/65n/6ZD/6ZX5xzT/6JH5yDnWZB6zAAAAIHRSTlMA/Qr2+wTmuKhY/vLqr4tbJ+7e29PHuKako6BlMiAZF9FhIv8AAACQSURBVDjL7dNHEsIwEETRlhklZ3KGEdz/joiCBZaxPQfwX7/qXQPtsQzfik19wVDtKvxW1NkA3IekXV9qxMpn2iHrpj/ykZbni25r59+QBSl3/wtVEhE74SLxGSySvAXLWoKFzXCGfahkTskXjcwZWFaSK1h4JiU4lwdclJPuBOBqiSck2RtiuqnMGDNVo4EXR0+KdXBuHAMAAAAASUVORK5CYII="}}]);