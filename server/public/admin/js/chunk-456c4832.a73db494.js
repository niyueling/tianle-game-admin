(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-456c4832"],{1832:function(t,e,r){"use strict";r.r(e);r("d9e2");var s=r("9ab4"),a=r("1b40"),i=r("68eb"),o=r("4201"),l=r("b3ad");let n=class extends a.e{constructor(){super(...arguments),this.mode=o.f.ADD,this.identity=null,this.roleList=[],this.form={account:"",name:"",password:"",password_confirm:"",role_id:"",disable:0,multipoint_login:1,avatar:""},this.validatePassword=[{required:!0,message:"请输入密码",trigger:"blur"},{validator:(t,e,r)=>{e?r():r(new Error("请输入密码"))},trigger:"blur"}],this.validatePasswordConfirm=[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:(t,e,r)=>{this.form.password&&(e||r(new Error("请再次输入密码")),e!==this.form.password&&r(new Error("两次输入密码不一致!"))),r()},trigger:"blur"}],this.rules={account:[{required:!0,message:"请输入账号",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}],role_id:[{required:!0,message:"请选择角色",trigger:"change"}],password:[],password_confirm:[]}}onSubmit(t){this.$refs[t].validate(t=>{if(t)switch(this.mode){case o.f.ADD:return this.handleAdminAdd();case o.f.EDIT:return this.handleAdminEdit()}})}handleAdminAdd(){const t=this.form;Object(i.a)(t).then(()=>{this.$message.success("添加成功!"),setTimeout(()=>this.$router.go(-1),500)}).catch(()=>{this.$message.error("保存失败!")})}handleAdminEdit(){const t=this.form,e=this.identity;Object(i.d)({...t,id:e}).then(()=>{this.$message.success("修改成功!"),setTimeout(()=>this.$router.go(-1),500)}).catch(()=>{this.$message.error("保存失败!")})}geRoleList(){Object(i.k)({page_type:1}).then(t=>{this.roleList=t.lists})}initFormDataForAdminEdit(){Object(i.c)({id:this.identity}).then(t=>{Object.keys(t).map(e=>{this.$set(this.form,e,t[e])})}).catch(()=>{this.$message.error("数据初始化失败，请刷新重载！")})}created(){const t=this.$route.query;t.mode&&(this.mode=t.mode),this.mode===o.f.EDIT&&(this.identity=1*t.id,this.initFormDataForAdminEdit()),this.mode===o.f.ADD&&(this.$set(this.rules,"password",this.validatePassword),this.$set(this.rules,"password_confirm",this.validatePasswordConfirm)),this.geRoleList()}changePasswordInput(t){this.mode===o.f.EDIT&&(t?this.$set(this.rules,"password_confirm",this.validatePasswordConfirm):this.$set(this.rules,"password_confirm",[]))}};Object(s.a)([Object(a.f)("form.password")],n.prototype,"changePasswordInput",null),n=Object(s.a)([Object(a.a)({components:{MaterialSelect:l.a}})],n);var c=n,d=(r("2a57"),r("2877")),m=Object(d.a)(c,(function(){var t=this,e=this,r=e.$createElement,s=e._self._c||r;return s("div",{staticClass:"ls-add-admin"},[s("div",{staticClass:"ls-card"},[s("el-page-header",{attrs:{content:e.identity?"编辑管理员":"添加管理员"},on:{back:function(t){return e.$router.go(-1)}}})],1),s("div",{staticClass:"ls-card m-t-16"},[s("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"120px",size:"small"}},[s("el-form-item",{attrs:{label:"账号",prop:"account"}},[s("el-input",{staticClass:"ls-input",attrs:{placeholder:"请输入账号",disabled:1==e.form.root},model:{value:e.form.account,callback:function(t){e.$set(e.form,"account",t)},expression:"form.account"}})],1),s("el-form-item",{attrs:{label:"名称",prop:"name"}},[s("el-input",{staticClass:"ls-input",attrs:{placeholder:"请输入名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),s("el-form-item",{attrs:{label:"角色",prop:"role_id"}},[s("el-select",{attrs:{placeholder:"请选择角色",disabled:1==e.form.root},model:{value:e.form.role_id,callback:function(t){e.$set(e.form,"role_id",t)},expression:"form.role_id"}},[1==e.form.root?s("el-option",{attrs:{label:"超级管理员",value:0}}):e._e(),e._l(e.roleList,(function(t,e){return s("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],2)],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{staticClass:"ls-input",attrs:{"show-word-limit":"",placeholder:"请输入密码"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),s("el-form-item",{attrs:{label:"确认密码",prop:"password_confirm"}},[s("el-input",{staticClass:"ls-input",attrs:{"show-word-limit":"",placeholder:"请输入确认密码"},model:{value:e.form.password_confirm,callback:function(t){e.$set(e.form,"password_confirm",t)},expression:"form.password_confirm"}})],1),s("el-form-item",{attrs:{label:"管理员状态"}},[s("el-switch",{attrs:{"active-value":0,"inactive-value":1,"active-color":e.styleConfig.primary,"inactive-color":"#f4f4f5",disabled:1==e.form.root},on:{change:function(e){return t.$set(t.form,"disable",e)}},model:{value:e.form.disable,callback:function(t){e.$set(e.form,"disable",t)},expression:"form.disable"}}),1==e.form.root?s("div",{staticClass:"muted"},[e._v("系统管理员状态不允许关闭")]):e._e()],1),s("el-form-item",{attrs:{label:"支持多处登录"}},[s("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":e.styleConfig.primary,"inactive-color":"#f4f4f5"},on:{change:function(e){return t.$set(t.form,"multipoint_login",e)}},model:{value:e.form.multipoint_login,callback:function(t){e.$set(e.form,"multipoint_login",t)},expression:"form.multipoint_login"}})],1),s("el-form-item",{attrs:{label:"管理员头像"}},[s("material-select",{attrs:{limit:1},model:{value:e.form.avatar,callback:function(t){e.$set(e.form,"avatar",t)},expression:"form.avatar"}})],1)],1)],1),s("div",{staticClass:"bg-white ls-fixed-footer"},[s("div",{staticClass:"row-center flex",staticStyle:{height:"100%"}},[s("el-button",{attrs:{size:"small"},on:{click:function(t){return e.$router.go(-1)}}},[e._v("取消")]),s("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.onSubmit("form")}}},[e._v("保存")])],1)])])}),[],!1,null,"507b217c",null);e.default=m.exports},"2a57":function(t,e,r){"use strict";r("a54f")},"68eb":function(t,e,r){"use strict";r.d(e,"e",(function(){return a})),r.d(e,"c",(function(){return i})),r.d(e,"a",(function(){return o})),r.d(e,"b",(function(){return l})),r.d(e,"d",(function(){return n})),r.d(e,"k",(function(){return c})),r.d(e,"i",(function(){return d})),r.d(e,"g",(function(){return m})),r.d(e,"j",(function(){return u})),r.d(e,"h",(function(){return f})),r.d(e,"f",(function(){return h}));var s=r("f175");const a=t=>s.a.get("/auth.admin/lists",{params:t}),i=t=>s.a.get("/auth.admin/detail",{params:t}),o=t=>s.a.post("/auth.admin/add",t),l=t=>s.a.post("/auth.admin/delete",t),n=t=>s.a.post("/auth.admin/edit",t),c=t=>s.a.get("/auth.role/lists",{params:t}),d=t=>s.a.get("/auth.role/detail",{params:t}),m=t=>s.a.post("/auth.role/add",t),u=t=>s.a.post("/auth.role/edit",t),f=t=>s.a.post("/auth.role/delete",t),h=()=>s.a.post("/config/getMenu")},a54f:function(t,e,r){}}]);