(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-e7ae00e4"],{"0cbf":function(t,e,s){"use strict";s.d(e,"a",(function(){return i})),s.d(e,"e",(function(){return a})),s.d(e,"g",(function(){return l})),s.d(e,"c",(function(){return n})),s.d(e,"h",(function(){return d})),s.d(e,"l",(function(){return u})),s.d(e,"k",(function(){return c})),s.d(e,"d",(function(){return r})),s.d(e,"f",(function(){return p})),s.d(e,"m",(function(){return _})),s.d(e,"i",(function(){return m})),s.d(e,"n",(function(){return b})),s.d(e,"j",(function(){return g})),s.d(e,"b",(function(){return v}));var o=s("f175");const i=t=>o.a.post("/marketing.coupon/add",t),a=t=>o.a.post("/marketing.coupon/edit",t),l=t=>o.a.get("/marketing.coupon/lists",{params:t}),n=t=>o.a.post("/marketing.coupon/delete",t),d=t=>o.a.post("/marketing.coupon/open",t),u=t=>o.a.post("/marketing.coupon/stop",t),c=t=>o.a.post("/marketing.coupon/sort",t),r=t=>o.a.get("/marketing.coupon/detail",{params:{id:t}}),p=t=>o.a.get("/marketing.coupon/info",{params:{id:t}}),_=()=>o.a.get("/marketing.coupon/survey"),m=t=>o.a.get("/marketing.coupon/record",{params:t}),b=t=>o.a.post("/marketing.coupon/void",t),g=t=>o.a.post("/marketing.coupon/send",t),v=t=>o.a.get("/marketing.coupon/commonLists",{params:t})},"431f":function(t,e,s){"use strict";s("6e21")},"54df":function(t,e,s){"use strict";s.r(e);var o=s("9ab4"),i=s("1b40"),a=s("5cf7"),l=s("f50c"),n=s("6ddb"),d=s("0cbf");let u=class extends i.e{constructor(){super(...arguments),this.disabled=!1,this.status=0,this.couponList={name:"",money:"",condition_type:1,condition_money:"",send_total_type:1,send_total:"",use_time_type:1,use_time_start:"",use_time_end:"",use_time:"",use_time1:"",get_type:1,get_num_type:1,get_num:"",get_num1:"",use_goods_type:1,use_goods_ids:[]},this.goodsSelectData=[],this.rules={name:[{required:!0,message:"请输入优惠券名称",trigger:["blur","change"]}],money:[{required:!0,message:"请输入优惠券面额",trigger:["blur","change"]}],send_total:[{required:!0,message:"请输入发放数量",trigger:["blur","change"]}]}}add(t){return t<10?"0"+t:t}baseTime(t){const e=new Date(t);return`${this.add(e.getFullYear())}-${this.add(e.getMonth()+1)}-${this.add(e.getDate())} ${this.add(e.getHours())}:${this.add(e.getMinutes())}:${this.add(e.getSeconds())}`}startTime(t){this.couponList.use_time_start=this.baseTime(t)}endTime(t){this.couponList.use_time_end=this.baseTime(t)}goodsData(t){t.length<=0||(this.goodsSelectData=t)}removeSelectGoods(t){for(let e=0;e<this.goodsSelectData.length;e++)this.goodsSelectData[e].id==t&&this.goodsSelectData.splice(e,1)}submit(t){this.$refs[t].validate(t=>{t&&(3==this.couponList.get_num_type&&(this.couponList.get_num=this.couponList.get_num1),3==this.couponList.use_time_type&&(this.couponList.use_time=this.couponList.use_time1),1!==this.couponList.use_goods_type?this.couponList.use_goods_ids=this.goodsSelectData.map(t=>t.id):this.couponList.use_goods_ids=[],this.id?this.couponEdit():this.couponAdd())})}couponEdit(){Object(d.e)({...this.couponList}).then(t=>{setTimeout(()=>this.$router.go(-1),500)})}couponAdd(){Object(d.a)({...this.couponList}).then(t=>{setTimeout(()=>this.$router.go(-1),500)})}getCouponDetail(){Object(d.d)(this.id).then(t=>{3==t.get_num_type&&(t.get_num1=t.get_num,t.get_num=""),3==t.use_time_type&&(t.use_time1=t.use_time,t.use_time=""),t.goods&&(this.goodsSelectData=t.goods),this.couponList=t})}created(){this.status=this.$route.query.status,this.disabled="true"==this.$route.query.disabled,this.id=this.$route.query.id,this.id&&this.getCouponDetail(),this.submit=Object(n.h)(this.submit,2e3)}};u=Object(o.a)([Object(i.a)({components:{AreaSelect:a.a,GoodsSelect:l.a}})],u);var c=u,r=(s("431f"),s("2877")),p=Object(r.a)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ls-coupon-edit"},[s("div",{staticClass:"ls-card ls-coupon-edit__header"},[0==t.status?s("el-page-header",{attrs:{content:"优惠券详情"},on:{back:function(e){return t.$router.go(-1)}}}):s("el-page-header",{attrs:{content:t.id?"编辑优惠券活动":"新增优惠券活动"},on:{back:function(e){return t.$router.go(-1)}}})],1),s("el-form",{ref:"couponList",attrs:{rules:t.rules,model:t.couponList,"label-width":"120px",size:"small"}},[s("div",{staticClass:"ls-card ls-coupon-edit__form m-t-10"},[s("div",{staticClass:"lg weight-500 m-b-20"},[t._v("基本信息")]),s("el-form-item",{attrs:{label:"优惠券名称",prop:"name",required:""}},[s("el-input",{staticClass:"ls-input",attrs:{disabled:2!=t.status&&t.disabled,placeholder:"请输入优惠券名称"},model:{value:t.couponList.name,callback:function(e){t.$set(t.couponList,"name",e)},expression:"couponList.name"}})],1),s("el-form-item",{attrs:{label:"发放总量",prop:"send_total_type"}},[s("div",[s("el-radio",{attrs:{border:"",disabled:2!=t.status&&t.disabled,label:1},model:{value:t.couponList.send_total_type,callback:function(e){t.$set(t.couponList,"send_total_type",e)},expression:"couponList.send_total_type"}},[t._v(" 不限制数量")])],1),s("div",{staticClass:"flex m-t-24"},[s("el-radio",{attrs:{border:"",disabled:2!=t.status&&t.disabled,label:2},model:{value:t.couponList.send_total_type,callback:function(e){t.$set(t.couponList,"send_total_type",e)},expression:"couponList.send_total_type"}},[t._v(" 发放 ")]),s("el-input",{staticClass:"ls-input",attrs:{disabled:2!=t.status&&t.disabled,size:"small"},model:{value:t.couponList.send_total,callback:function(e){t.$set(t.couponList,"send_total",e)},expression:"couponList.send_total"}},[s("template",{slot:"append"},[t._v("张")])],2)],1),s("span",{staticClass:"desc"},[t._v("编辑进行中的优惠券，发放总量只能增加不能减少，请谨慎设置。最多1000000张。")])]),s("el-form-item",{attrs:{label:"用券时间",prop:"send_total_type"}},[s("div",{staticClass:"m-b-24"},[s("el-radio",{attrs:{disabled:t.disabled,label:1},model:{value:t.couponList.use_time_type,callback:function(e){t.$set(t.couponList,"use_time_type",e)},expression:"couponList.use_time_type"}},[t._v("固定日期")]),s("el-date-picker",{attrs:{disabled:t.disabled,type:"datetime",placeholder:"开始日期"},model:{value:t.couponList.use_time_start,callback:function(e){t.$set(t.couponList,"use_time_start",e)},expression:"couponList.use_time_start"}}),t._v(" 至 "),s("el-date-picker",{attrs:{disabled:t.disabled,type:"datetime",placeholder:"结束日期"},model:{value:t.couponList.use_time_end,callback:function(e){t.$set(t.couponList,"use_time_end",e)},expression:"couponList.use_time_end"}}),t._v(" 可用 ")],1),s("div",{staticClass:"flex"},[s("el-radio",{attrs:{border:"",disabled:t.disabled,label:2},model:{value:t.couponList.use_time_type,callback:function(e){t.$set(t.couponList,"use_time_type",e)},expression:"couponList.use_time_type"}},[t._v(" 领券当日起 ")]),s("el-input",{staticClass:"ls-input",attrs:{disabled:t.disabled,size:"small"},model:{value:t.couponList.use_time,callback:function(e){t.$set(t.couponList,"use_time",e)},expression:"couponList.use_time"}},[s("template",{slot:"append"},[t._v("天内可用")])],2)],1),s("span",{staticClass:"desc"},[t._v("至少需要填写1天")]),s("div",{staticClass:"flex"},[s("el-radio",{attrs:{border:"",disabled:t.disabled,label:3},model:{value:t.couponList.use_time_type,callback:function(e){t.$set(t.couponList,"use_time_type",e)},expression:"couponList.use_time_type"}},[t._v(" 领券次日起 ")]),s("el-input",{staticClass:"ls-input",attrs:{disabled:t.disabled,size:"small"},model:{value:t.couponList.use_time1,callback:function(e){t.$set(t.couponList,"use_time1",e)},expression:"couponList.use_time1"}},[s("template",{slot:"append"},[t._v("天内可用")])],2)],1),s("span",{staticClass:"desc"},[t._v("至少需要填写1天")])])],1),s("div",{staticClass:"ls-card ls-coupon-edit__form m-t-10"},[s("div",{staticClass:"lg weight-500 m-b-20"},[t._v("优惠设置")]),s("el-form-item",{attrs:{label:"优惠券面额",prop:"money"}},[s("el-input",{staticClass:"ls-input",attrs:{disabled:t.disabled},model:{value:t.couponList.money,callback:function(e){t.$set(t.couponList,"money",e)},expression:"couponList.money"}}),s("span",{staticClass:"desc"},[t._v("面额需大于0元，支持两位小数")])],1),s("el-form-item",{attrs:{label:"使用门槛",prop:"condition_type"}},[s("div",[s("el-radio",{attrs:{disabled:t.disabled,border:"",label:1},model:{value:t.couponList.condition_type,callback:function(e){t.$set(t.couponList,"condition_type",e)},expression:"couponList.condition_type"}},[t._v("无门槛使用 ")])],1),s("div",{staticClass:"flex m-t-24"},[s("el-radio",{attrs:{border:"",disabled:t.disabled,label:2},model:{value:t.couponList.condition_type,callback:function(e){t.$set(t.couponList,"condition_type",e)},expression:"couponList.condition_type"}},[t._v(" 订单满 ")]),s("el-input",{staticClass:"ls-input",attrs:{disabled:t.disabled,size:"small"},model:{value:t.couponList.condition_money,callback:function(e){t.$set(t.couponList,"condition_money",e)},expression:"couponList.condition_money"}},[s("template",{slot:"append"},[t._v("元可使用")])],2)],1),s("span",{staticClass:"desc"},[t._v("需要填写大于优惠券面额的数额")])]),s("el-form-item",{attrs:{label:"使用范围",prop:"use_goods_type"}},[s("el-radio",{attrs:{border:"",disabled:t.disabled,label:1},model:{value:t.couponList.use_goods_type,callback:function(e){t.$set(t.couponList,"use_goods_type",e)},expression:"couponList.use_goods_type"}},[t._v("全场通用")]),s("el-radio",{attrs:{border:"",disabled:t.disabled,label:2},model:{value:t.couponList.use_goods_type,callback:function(e){t.$set(t.couponList,"use_goods_type",e)},expression:"couponList.use_goods_type"}},[t._v("部分商品可用 ")]),s("el-radio",{attrs:{border:"",disabled:t.disabled,label:3},model:{value:t.couponList.use_goods_type,callback:function(e){t.$set(t.couponList,"use_goods_type",e)},expression:"couponList.use_goods_type"}},[t._v("部分商品不可用 ")]),1!==t.couponList.use_goods_type?s("div",{staticClass:"m-t-24"},[t.disabled?t._e():s("goods-select",{attrs:{mode:"ll",params:{type:0},"show-virtual-goods":!0},model:{value:t.goodsSelectData,callback:function(e){t.goodsSelectData=e},expression:"goodsSelectData"}},[s("el-button",{attrs:{slot:"trigger",disabled:t.disabled,size:"small",type:"primary"},slot:"trigger"},[t._v("选择商品")])],1),0!=t.goodsSelectData.length?s("el-table",{ref:"paneTable",staticClass:"m-t-24",staticStyle:{width:"100%"},attrs:{size:"small",data:t.goodsSelectData}},[s("el-table-column",{attrs:{prop:"code",label:"商品编码",width:"110"}}),s("el-table-column",{attrs:{label:"商品信息","min-width":"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"flex"},[s("el-image",{staticClass:"flex-none",staticStyle:{width:"58px",height:"58px"},attrs:{src:e.row.image}}),s("div",{staticClass:"goods-info m-l-8"},[s("div",{staticClass:"line-2"},[t._v(t._s(e.row.name))])])],1)]}}],null,!1,977849216)}),s("el-table-column",{attrs:{label:"价格",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.max_price)+" ")]}}],null,!1,1062266139)}),s("el-table-column",{attrs:{label:"操作",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{disabled:t.disabled,type:"text",size:"small"},on:{click:function(s){return t.removeSelectGoods(e.row.id)}}},[t._v("移除")])]}}],null,!1,1973233545)})],1):t._e()],1):t._e()],1)],1),s("div",{staticClass:"ls-card ls-coupon-edit__form m-t-10"},[s("div",{staticClass:"lg weight-500 m-b-20"},[t._v("发放设置")]),s("el-form-item",{attrs:{label:"推广方式",prop:"get_type",required:""}},[s("el-radio",{attrs:{border:"",disabled:t.disabled,label:1},model:{value:t.couponList.get_type,callback:function(e){t.$set(t.couponList,"get_type",e)},expression:"couponList.get_type"}},[t._v("买家领取")]),s("el-radio",{attrs:{border:"",disabled:t.disabled,label:2},model:{value:t.couponList.get_type,callback:function(e){t.$set(t.couponList,"get_type",e)},expression:"couponList.get_type"}},[t._v("卖家发放")])],1),s("el-form-item",{attrs:{label:"领取次数",prop:"get_num_type"}},[s("el-radio-group",{model:{value:t.couponList.get_num_type,callback:function(e){t.$set(t.couponList,"get_num_type",e)},expression:"couponList.get_num_type"}},[s("div",{staticClass:"m-t-10"},[s("el-radio",{attrs:{border:"",disabled:t.disabled,label:1}},[t._v("不限制领取次数")])],1),s("div",{staticClass:"m-t-24 flex"},[s("el-radio",{attrs:{border:"",disabled:t.disabled,label:2}},[t._v(" 限制领取 ")]),s("el-input",{staticClass:"ls-input",attrs:{disabled:t.disabled,size:"small"},model:{value:t.couponList.get_num,callback:function(e){t.$set(t.couponList,"get_num",e)},expression:"couponList.get_num"}},[s("template",{slot:"append"},[t._v("次")])],2)],1),s("div",{staticClass:"m-t-24 flex"},[s("el-radio",{attrs:{border:"",disabled:t.disabled,label:3}},[t._v(" 每天限制领取 ")]),s("el-input",{staticClass:"ls-input",attrs:{disabled:t.disabled,size:"small"},model:{value:t.couponList.get_num1,callback:function(e){t.$set(t.couponList,"get_num1",e)},expression:"couponList.get_num1"}},[s("template",{slot:"append"},[t._v("次")])],2)],1)]),s("span",{staticClass:"desc"},[t._v("领取次数只对买家领取的场景有效")])],1)],1)]),s("div",{staticClass:"ls-coupon-edit__footer bg-white ls-fixed-footer"},[s("div",{staticClass:"btns row-center flex",staticStyle:{height:"100%"}},[s("el-button",{attrs:{size:"small"},on:{click:function(e){return t.$router.go(-1)}}},[t._v("取消")]),s("el-button",{attrs:{size:"small",disabled:2!=t.status&&t.disabled,type:"primary"},on:{click:function(e){return t.submit("couponList")}}},[t._v("保存")])],1)])],1)}),[],!1,null,"6257a7f2",null);e.default=p.exports},"5cf7":function(t,e,s){"use strict";var o=s("9ab4"),i=s("0463"),a=s("1b40");let l=class extends a.e{constructor(){super(...arguments),this.options=i.a}get areaValue(){return[this.province,this.city,this.district]}set areaValue(t){this.$emit("update:province",t[0]),this.$emit("update:city",t[1]),this.$emit("update:district",t[2])}};Object(o.a)([Object(a.c)()],l.prototype,"province",void 0),Object(o.a)([Object(a.c)()],l.prototype,"city",void 0),Object(o.a)([Object(a.c)()],l.prototype,"district",void 0),Object(o.a)([Object(a.c)({default:"380px"})],l.prototype,"width",void 0),l=Object(o.a)([a.a],l);var n=l,d=s("2877"),u=Object(d.a)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"area-select"},[s("el-cascader",{style:{width:t.width},attrs:{options:t.options},model:{value:t.areaValue,callback:function(e){t.areaValue=e},expression:"areaValue"}})],1)}),[],!1,null,null,null);e.a=u.exports},"6e21":function(t,e,s){}}]);